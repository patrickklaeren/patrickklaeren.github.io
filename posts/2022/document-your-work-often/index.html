<!doctype html><html lang=en-US class="scroll-smooth dark"><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>patrickk.io | A lesson on documenting your work early, often and securely</title><meta name=description content="If there&rsquo;s one thing that I would yell at myself when first getting started with software development or, for that matter, any project in general, it would be to document early, often and securely. Here&rsquo;s my story of creating a software company&rsquo;s wiki, backed by Azure AD, with Git as storage."><link rel=canonical href=https://patrickk.io/posts/2022/document-your-work-often/><link rel=robots href=/robots.txt><link rel=icon type=image/x-icon href=/icons/favicon.ico><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type=text/x-mathjax-config>MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script><link rel=stylesheet href="https://patrickk.io/css/app.min.2cb70fb9f83d081ead4c74dfa601dd3c78c84840b4c1a660eb0c1c72dd66c3ba.css" integrity="sha256-LLcPufg9CB6tTHTfpgHdPHjISEC0waZg6wwcct1mw7o="></head><body class="max-w-screen-md mx-auto px-2.5"><div class=header><header class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 py-12"><div class="flex-none w-20 h-20 rounded-full overflow-hidden"><a href=https://patrickk.io/><img srcset="/img/logo_hu_be36e67451a71f56.png 80w" src=/img/logo.png width=1080 height=1080 alt=patrickk.io></a></div><div class="flex flex-col gap-5"><a href=https://patrickk.io/><h1 id=site-title>patrickk.io</h1></a><nav><ul class="flex justify-start"><li><a href=/>Home</a></li><li><a href=/about>About me</a></li></ul></nav></div></header><button class=toggle-theme aria-label="Toggle Theme" title="Toggle Theme" onclick=toggleTheme()>
<span class="theme-icon light"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75.0 11-7.5.0 3.75 3.75.0 017.5.0z"/></svg> </span><span class="theme-icon dark"><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718.0 0118 15.75c-5.385.0-9.75-4.365-9.75-9.75.0-1.33.266-2.597.748-3.752A9.753 9.753.0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753.0 009.002-5.998z"/></svg> </span></button>
<script>document.addEventListener("DOMContentLoaded",function(){const e=localStorage.getItem("theme");setTheme(!e||e==="light"?"light":e)});function setTheme(e){const t=document.querySelector("html");localStorage.setItem("theme",e),e==="light"?(t.classList.contains("dark")&&document.querySelector("html").classList.remove("dark"),document.querySelector(".theme-icon.light").style.display="none",document.querySelector(".theme-icon.dark").style.display="block"):(t.classList.contains("dark")||document.querySelector("html").classList.add("dark"),document.querySelector(".theme-icon.dark").style.display="none",document.querySelector(".theme-icon.light").style.display="block")}function toggleTheme(){const e=localStorage.getItem("theme");setTheme(e==="light"?"dark":"light")}</script></div><main id=content><article class="flex flex-col gap-10"><header class="flex flex-col gap-0"><h1>A lesson on documenting your work early, often and securely</h1><div class=meta><time datetime="2022-02-27 00:00:00 +0000 UTC" title='Sun, Feb 27, 2022, 12:00 AM UTC'>27/02/2022</time></div></header><section><p>If there&rsquo;s one thing that I would yell at myself when first getting started with software development or, for that matter, any project in general, it would be to document early, often and securely. Here&rsquo;s my story of creating a software company&rsquo;s wiki, backed by Azure AD, with Git as storage.</p><p>It&rsquo;s not a secret that the time investment required for documentation is either underestimated or just not allocated in the first place. Most enterprise scenarios won&rsquo;t ever account for documentation. Elaborations care little for the technical writing that will, or <em>should</em> be required and stakeholders simply do not see the return on investment for documenting systems that, in ten years, might still be running but under a completely different set of eyes from those that originally envisioned the implementation. Open source projects generally fair better in this department, but even there poor devops can cause labourious tasks and lagging updates.</p><p>If code is your business I cannot stress enough how you should invest early into documenting your technical processes, projects and other jobs that you might be doing regularly but are thought-expensive.</p><p>Identify your minimum requirements of at least getting words onto a screen, securely.</p><h2 id=in-an-ideal-world>In an ideal world</h2><p><strong>Absolutes:</strong></p><ul><li>Be backed by markdown files</li><li>Be source controlled in a Git repository, alongside all of our other projects</li><li>Allow for each pushing of new articles, whereby pushing to the repo would trigger a build pipeline</li><li>Have low effort authentication and authorisation, maybe even be managed by an existing SSO option. We already make use of AzureAD almost everywhere</li></ul><p><strong>Nice-to-haves:</strong></p><ul><li>Mermaid diagram integration</li><li>Syntax highlighting for codeblocks</li><li>Built in markdown editing</li></ul><h2 id=what-we-tried>What we tried</h2><p>For a number of years we had tried several solutions;</p><p><strong>A Word document in OneDrive</strong></p><p>While Microsoft&rsquo;s realtime collaboration tools are great and worked flawlessly for us - it&rsquo;s Word at the end of the day. It&rsquo;s OneDrive and just yuck. There&rsquo;s no real version control. It&rsquo;s hard to format, and we all know the problems of dragging images around. It&rsquo;s just not a flexible solution at scale. Code is horrific in Word.</p><p><strong>Confluence</strong></p><p>We were already in the Atlassian ecosystem. We used Jira, Bitbucket, and had the unfortunate luck of also using Hipchat for a small period of time. It made sense to try Confluence. Atlassian even has its own SSO capabilities across all products. One account, access to all products. Unfortunately Confluence is also incredibly convoluted. I have no doubt it functions well for large, critical, installations where there&rsquo;s a strict structure, with teams to maintain the many nuts and bolts within Confluence. We&rsquo;re small and don&rsquo;t have time to deal with the governance models Confluence <em>would</em> want to impose on you.</p><p><strong>Azure DevOps Wiki</strong></p><p>When we migrated to Azure Devops and moved repos, CI/CD pipelines and issues to the same platform, we also decided to try out the built in Wiki functionality. Surprisingly it checks off many of the requirements. It being on Microsoft&rsquo;s Azure platform means authentication just works, the wiki is source controlled, it&rsquo;s immediately updated and can be edited in the browser. There is some proprietary(?) formatting to order the menu, but that&rsquo;s just one file. You might think, ok, so that&rsquo;s end of story? Well. Being on Azure Devops Wiki ties you into Azure DevOps. You can&rsquo;t just pick up your docs repo and put it elsehwere.</p><p><strong>GitHub Wiki</strong></p><p>Same problems Azure DevOps suffers of, and no integration with any other SSO providers.</p><h2 id=the-solution>The solution</h2><p>Any other solution compromised of expensive cloud-hosted solutions that wanted to store our documents themselves or self-hosting a maintenance heavy application. I wasn&rsquo;t in this to create more problems. I changed thought processes and went to look for static site from markdown generators.</p><p>Happily with the advent of ASP.NET Core, static file serving was baked right in and made easier than ever. What I had hoped to do was place whatever static site I would generate behind an ASP.NET Core-served website with AzureAD on the ASP.NET Core end, authenticating any request to any static file. That way, even if the underlying wiki technology changed, authentication (and, cruicially routing) would always remain the same.</p><p>I ended up using a new ASP.NET Core MVC app for this, for better control (pun not intended). <code>dotnet new mvc</code> or your equivalent options in your IDE of choice should be enough to get started.</p><p>Your next move is to add Azure AD authentication. This is documentated <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/web-app-quickstart?pivots=devlang-aspnet-core">here</a>.</p><p>The <code>Program.cs</code> file will end up looking like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#ff79c6>using</span> Microsoft.AspNetCore.Authentication.OpenIdConnect;
</span></span><span style=display:flex><span><span style=color:#ff79c6>using</span> Microsoft.AspNetCore.Builder;
</span></span><span style=display:flex><span><span style=color:#ff79c6>using</span> Microsoft.Extensions.DependencyInjection;
</span></span><span style=display:flex><span><span style=color:#ff79c6>using</span> Microsoft.Identity.Web;
</span></span><span style=display:flex><span><span style=color:#ff79c6>using</span> Microsoft.Identity.Web.UI;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>var</span> builder = WebApplication.CreateBuilder(args);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>builder.Services.AddControllers();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>builder.Services
</span></span><span style=display:flex><span>    .AddAuthentication(OpenIdConnectDefaults.AuthenticationScheme)
</span></span><span style=display:flex><span>    .AddMicrosoftIdentityWebApp(builder.Configuration.GetSection(<span style=color:#f1fa8c>&#34;AzureAd&#34;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>builder.Services.AddAuthorization();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>builder.Services
</span></span><span style=display:flex><span>    .AddRazorPages()
</span></span><span style=display:flex><span>    .AddMicrosoftIdentityUI();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>var</span> app = builder.Build();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app.UseHttpsRedirection();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app.UseRouting();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app.UseAuthentication();
</span></span><span style=display:flex><span>app.UseAuthorization();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8be9fd>var</span> options = <span style=color:#ff79c6>new</span> DefaultFilesOptions();
</span></span><span style=display:flex><span>options.DefaultFileNames.Clear();
</span></span><span style=display:flex><span>options.DefaultFileNames.Add(<span style=color:#f1fa8c>&#34;index.html&#34;</span>);
</span></span><span style=display:flex><span>app.UseDefaultFiles(options);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#6272a4>// Must be after authorisation</span>
</span></span><span style=display:flex><span>app.UseStaticFiles(<span style=color:#ff79c6>new</span> StaticFileOptions
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    OnPrepareResponse = ctx =&gt;
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> (ctx.Context.User <span style=color:#ff79c6>is</span> not { Identity: { IsAuthenticated: <span style=color:#ff79c6>true</span> } })
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            ctx.Context.Response.Redirect(<span style=color:#f1fa8c>&#34;/MicrosoftIdentity/Account/SignIn&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app.UseEndpoints(endpoints =&gt;
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    endpoints.MapRazorPages();
</span></span><span style=display:flex><span>    endpoints.MapControllers();
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>app.Run();
</span></span></code></pre></div><p>So important shout outs here being the enabling of static files. ASP.NET Core will serve our static files, generated by our documentation platform of choice. If the user is not authenticated, via our AzureAD, we direct them back to the Identity login page for Azure AD. Something we don&rsquo;t need to worry about.</p><p>We have some additional logic in our Home Controller to serve the static index file, generated by MkDocs - you <em>could</em> use ASP.NET Core&rsquo;s new minimal APIs to strip some of this out, but I prefer the control (again, not a pun) of controllers.</p><p>Our home controller looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#ff79c6>using</span> System.IO;
</span></span><span style=display:flex><span><span style=color:#ff79c6>using</span> Microsoft.AspNetCore.Hosting;
</span></span><span style=display:flex><span><span style=color:#ff79c6>using</span> Microsoft.AspNetCore.Mvc;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>namespace</span> Controllers;
</span></span><span style=display:flex><span><span style=color:#50fa7b>
</span></span></span><span style=display:flex><span><span style=color:#50fa7b>[Route(&#34;/&#34;)]</span>
</span></span><span style=display:flex><span><span style=color:#8be9fd;font-style:italic>public</span> <span style=color:#ff79c6>class</span> <span style=color:#50fa7b>HomeController</span> : Controller
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8be9fd;font-style:italic>public</span> IActionResult Index()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>if</span> (HttpContext.User <span style=color:#ff79c6>is</span> { Identity: { IsAuthenticated: <span style=color:#ff79c6>true</span> } })
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#8be9fd>var</span> path = Path.Combine(Directory.GetCurrentDirectory(), <span style=color:#f1fa8c>&#34;wwwroot&#34;</span>, <span style=color:#f1fa8c>&#34;index.html&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>return</span> PhysicalFile(path, <span style=color:#f1fa8c>&#34;text/html&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>return</span> Redirect(<span style=color:#f1fa8c>&#34;/MicrosoftIdentity/Account/SignIn&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>It&rsquo;s important to note that our documentation will eventually sit in the <code>wwwroot</code> folder of our ASP.NET Core site.</p><p>We&rsquo;re using <a href=https://www.mkdocs.org/>MkDocs</a>, more specifically <a href=https://squidfunk.github.io/mkdocs-material/>Material for MkDocs</a> to generate a static site from markdown documentation. Adding a new repository, separated from our ASP.NET Core site, hosting the documentation, would allow for an agnostic host and client. I.e. docs can exist without ASP.NET Core and ASP.NET Core can exist without docs.</p><p>MkDocs is a Python-based framework. While you won&rsquo;t be dealing with Python code, you will be dealing with <code>pip</code>. It is the bare minimum required to get MkDocs to work. This approach, of hosting the docs site through a ASP.NET Core host, however, does allow you to switch out MkDocs.</p><p>Our MkDocs configuration looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ff79c6>site_name</span>: Docs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>theme</span>:
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>name</span>: material
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>custom_dir</span>: overrides
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>palette</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>scheme</span>: default
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>toggle</span>:
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>icon</span>: material/toggle-switch-off-outline 
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>name</span>: Switch to dark mode
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>primary</span>: green
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>accent</span>: teal
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>scheme</span>: slate 
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>toggle</span>:
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>icon</span>: material/toggle-switch
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>name</span>: Switch to light mode
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>primary</span>: green
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>accent</span>: teal
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>features</span>:
</span></span><span style=display:flex><span>    - navigation.tracking
</span></span><span style=display:flex><span>    - navigation.tabs
</span></span><span style=display:flex><span>    - navigation.sections
</span></span><span style=display:flex><span>    - header.autohide
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>markdown_extensions</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ff79c6>pymdownx.highlight</span>:
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>anchor_linenums</span>: <span style=color:#ff79c6>true</span>
</span></span><span style=display:flex><span>  - <span style=color:#ff79c6>pymdownx.superfences</span>:
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>custom_fences</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ff79c6>name</span>: mermaid
</span></span><span style=display:flex><span>          <span style=color:#ff79c6>class</span>: mermaid
</span></span><span style=display:flex><span>          <span style=color:#ff79c6>format</span>: <span style=color:#ff79c6>!!python/name:pymdownx.superfences.fence_code_format</span>
</span></span><span style=display:flex><span>  - <span style=color:#ff79c6>pymdownx.tasklist</span>:
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>custom_checkbox</span>: <span style=color:#ff79c6>true</span>
</span></span><span style=display:flex><span>  - pymdownx.inlinehilite
</span></span><span style=display:flex><span>  - pymdownx.snippets
</span></span><span style=display:flex><span>  - def_list
</span></span><span style=display:flex><span>  - attr_list
</span></span><span style=display:flex><span>  - md_in_html
</span></span><span style=display:flex><span>  - meta
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>plugins</span>:
</span></span><span style=display:flex><span>  - search
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>extra</span>:
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>generator</span>: <span style=color:#ff79c6>false</span>
</span></span></code></pre></div><p>Once you&rsquo;re happy, build the static docs site and place it in the <code>wwwroot</code> folder of ASP.NET Core and watch your docs be served, securely.</p></section><footer></footer></article></main><footer class="pt-5 pb-10 grid gap-3 sm:grid-cols-2"><div class="text-xs font-semibold text-gray-500 order-2 sm:order-1">Â© 2025 -
<a href=https://patrickk.io/>patrickk.io</a></div><div class="order-1 sm:order-2"><ul class="flex sm:justify-end gap-5"><li><a href=https://github.com/patrickklaeren target=_blank rel="me noopener noreferrer">GitHub</a></li></ul></div></footer></body></html>